<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos -->
			<title>Docs For Class FileBasedAuthenticator</title>
			<link rel="stylesheet" href="../media/stylesheet.css" />
			<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'/>
		</head>
		<body>
			<div class="page-body">			
<h2 class="class-name">Class FileBasedAuthenticator</h2>

<a name="sec-description"></a>
<div class="info-box">
	<div class="info-box-title">Description</div>
	<div class="nav-bar">
					<span class="disabled">Description</span> |
															<a href="#sec-method-summary">Methods</a> (<a href="#sec-methods">details</a>)
						
					</div>
	<div class="info-box-body">
        		<!-- ========== Info from phpDoc block ========= -->
		<p class="notes">
			Located in <a class="field" href="_reference---FileBasedAuthenticator.php.html">/reference/FileBasedAuthenticator.php</a> (line <span class="field">25</span>)
		</p>
		
				
		<pre></pre>
	
			</div>
</div>




	<a name="sec-method-summary"></a>
	<div class="info-box">
		<div class="info-box-title">Method Summary</span></div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
												<span class="disabled">Methods</span> (<a href="#sec-methods">details</a>)
		</div>
		<div class="info-box-body">			
			<div class="method-summary">
																																																																																																																																																																																																				
												<div class="method-definition">
											<span class="method-result">FileBasedAuthenticator</span>
										<a href="#__construct" title="details" class="method-name">__construct</a>
										()
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#changePassword" title="details" class="method-name">changePassword</a>
											(<span class="var-type">user</span>&nbsp;<span class="var-name">$user</span>, <span class="var-type">currentPassword</span>&nbsp;<span class="var-name">$currentPassword</span>, <span class="var-type">newPassword</span>&nbsp;<span class="var-name">$newPassword</span>, <span class="var-type">newPassword2</span>&nbsp;<span class="var-name">$newPassword2</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#clearCurrent" title="details" class="method-name">clearCurrent</a>
										()
									</div>
																<div class="method-definition">
											<span class="method-result">the</span>
										<a href="#createUser" title="details" class="method-name">createUser</a>
											(<span class="var-type">accountName</span>&nbsp;<span class="var-name">$accountName</span>, <span class="var-type">password1</span>&nbsp;<span class="var-name">$password1</span>, <span class="var-type">password2</span>&nbsp;<span class="var-name">$password2</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">true,</span>
										<a href="#exists" title="details" class="method-name">exists</a>
											(<span class="var-type">accountName</span>&nbsp;<span class="var-name">$accountName</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">a</span>
										<a href="#generateStrongPassword" title="details" class="method-name">generateStrongPassword</a>
											([<span class="var-type">user</span>&nbsp;<span class="var-name">$user</span> = <span class="var-default">null</span>], [<span class="var-type">oldPassword</span>&nbsp;<span class="var-name">$oldPassword</span> = <span class="var-default">null</span>])
									</div>
																<div class="method-definition">
											<span class="method-result">a</span>
										<a href="#getAllHashedPasswords" title="details" class="method-name">getAllHashedPasswords</a>
											(<span class="var-type">user</span>&nbsp;<span class="var-name">$user</span>, <span class="var-type">create</span>&nbsp;<span class="var-name">$create</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">the</span>
										<a href="#getCurrentUser" title="details" class="method-name">getCurrentUser</a>
										()
									</div>
																<div class="method-definition">
											<span class="method-result">the</span>
										<a href="#getHashedPassword" title="details" class="method-name">getHashedPassword</a>
											(<span class="var-type">user</span>&nbsp;<span class="var-name">$user</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">the</span>
										<a href="#getOldPasswordHashes" title="details" class="method-name">getOldPasswordHashes</a>
											(<span class="var-type">user</span>&nbsp;<span class="var-name">$user</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">the</span>
										<a href="#getUserById" title="details" class="method-name">getUserById</a>
											(<span class="var-type">accountId</span>&nbsp;<span class="var-name">$accountId</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">the</span>
										<a href="#getUserByName" title="details" class="method-name">getUserByName</a>
											(<span class="var-type">accountName</span>&nbsp;<span class="var-name">$accountName</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">a</span>
										<a href="#getUserNames" title="details" class="method-name">getUserNames</a>
										()
									</div>
																<div class="method-definition">
											<span class="method-result">the</span>
										<a href="#hashPassword" title="details" class="method-name">hashPassword</a>
											(<span class="var-type">password</span>&nbsp;<span class="var-name">$password</span>, <span class="var-type">accountName</span>&nbsp;<span class="var-name">$accountName</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#loadUsersIfNecessary" title="details" class="method-name">loadUsersIfNecessary</a>
										()
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#loadUsersImmediately" title="details" class="method-name">loadUsersImmediately</a>
										()
									</div>
																<div class="method-definition">
											<span class="method-result">the</span>
										<a href="#login" title="details" class="method-name">login</a>
											(<span class="var-type">request</span>&nbsp;<span class="var-name">$request</span>, <span class="var-type">response</span>&nbsp;<span class="var-name">$response</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#logout" title="details" class="method-name">logout</a>
										()
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#removeUser" title="details" class="method-name">removeUser</a>
											(<span class="var-type">accountName</span>&nbsp;<span class="var-name">$accountName</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#saveUsers" title="details" class="method-name">saveUsers</a>
										()
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#setCurrentUser" title="details" class="method-name">setCurrentUser</a>
											(<span class="var-type">user</span>&nbsp;<span class="var-name">$user</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#verifyAccountNameStrength" title="details" class="method-name">verifyAccountNameStrength</a>
											(<span class="var-type">accountName</span>&nbsp;<span class="var-name">$accountName</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">true,</span>
										<a href="#verifyPassword" title="details" class="method-name">verifyPassword</a>
											(<span class="var-type">user</span>&nbsp;<span class="var-name">$user</span>, <span class="var-type">password</span>&nbsp;<span class="var-name">$password</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#verifyPasswordStrength" title="details" class="method-name">verifyPasswordStrength</a>
											(<span class="var-type">oldPassword</span>&nbsp;<span class="var-name">$oldPassword</span>, <span class="var-type">newPassword</span>&nbsp;<span class="var-name">$newPassword</span>)
									</div>
								</div>
		</div>
	</div>		

	
	<a name="sec-methods"></a>
	<div class="info-box">
		<div class="info-box-title">Methods</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
																<a href="#sec-method-summary">Methods</a> (<span class="disabled">details</span>)
						
		</div>
		<div class="info-box-body">
			<A NAME='method_detail'></A>

<a name="method__construct" id="__construct"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">Constructor __construct</span> (line <span class="line-number">46</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
	
	<div class="method-signature">
		<span class="method-result">FileBasedAuthenticator</span>
		<span class="method-name">
			__construct
		</span>
				()
			</div>
	
		
			
	</div>
<a name="methodchangePassword" id="changePassword"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">changePassword</span> (line <span class="line-number">270</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Changes the password for the specified user. This requires the current password, as well as  the password to replace it with. The new password should be checked against old hashes to be sure the new password does not closely resemble or equal any recent passwords for that User.</p>
<p class="description"><p>Password strength should also be verified.  This new password must be repeated to ensure that the user has typed it in correctly.</p></p>
	<ul class="tags">
				<li><span class="field">throws:</span> AuthenticationException          if any errors occur</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			changePassword
		</span>
					(<span class="var-type">user</span>&nbsp;<span class="var-name">$user</span>, <span class="var-type">currentPassword</span>&nbsp;<span class="var-name">$currentPassword</span>, <span class="var-type">newPassword</span>&nbsp;<span class="var-name">$newPassword</span>, <span class="var-type">newPassword2</span>&nbsp;<span class="var-name">$newPassword2</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">user</span>
				<span class="var-name">$user</span><span class="var-description">: the user to change the password for</span>			</li>
					<li>
				<span class="var-type">currentPassword</span>
				<span class="var-name">$currentPassword</span><span class="var-description">: the current password for the specified user</span>			</li>
					<li>
				<span class="var-type">newPassword</span>
				<span class="var-name">$newPassword</span><span class="var-description">: the new password to use</span>			</li>
					<li>
				<span class="var-type">newPassword2</span>
				<span class="var-name">$newPassword2</span><span class="var-description">: a verification copy of the new password</span>			</li>
				</ul>
		
			
	</div>
<a name="methodclearCurrent" id="clearCurrent"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">clearCurrent</span> (line <span class="line-number">58</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Clears the current User. This allows the thread to be reused safely.</p>
<p class="description"><p>This clears all threadlocal variables from the thread. This should ONLY be called after  all possible ESAPI operations have concluded. If you clear too early, many calls will  fail, including logging, which requires the user identity.</p></p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			clearCurrent
		</span>
				()
			</div>
	
		
			
	</div>
<a name="methodcreateUser" id="createUser"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">createUser</span> (line <span class="line-number">148</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Creates a new User with the information provided. Implementations should check  accountName and password for proper format and strength against brute force  attacks ( verifyAccountNameStrength(String), verifyPasswordStrength(String, String)  ).</p>
<p class="description"><p>Two copies of the new password are required to encourage user interface designers to  include a &quot;re-type password&quot; field in their forms. Implementations should verify that  both are the same.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> User that has been created</li>
				<li><span class="field">throws:</span> AuthenticationException          if user creation fails due to any of the qualifications listed in this method's description</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">the</span>
		<span class="method-name">
			createUser
		</span>
					(<span class="var-type">accountName</span>&nbsp;<span class="var-name">$accountName</span>, <span class="var-type">password1</span>&nbsp;<span class="var-name">$password1</span>, <span class="var-type">password2</span>&nbsp;<span class="var-name">$password2</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">accountName</span>
				<span class="var-name">$accountName</span><span class="var-description">: the account name of the new user</span>			</li>
					<li>
				<span class="var-type">password1</span>
				<span class="var-name">$password1</span><span class="var-description">: the password of the new user</span>			</li>
					<li>
				<span class="var-type">password2</span>
				<span class="var-name">$password2</span><span class="var-description">: the password of the new user.  This field is to encourage user interface designers to include two password fields in their forms.</span>			</li>
				</ul>
		
			
	</div>
<a name="methodexists" id="exists"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">exists</span> (line <span class="line-number">614</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Determine if the account exists.</p>
	<ul class="tags">
				<li><span class="field">return:</span> if the account exists</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">true,</span>
		<span class="method-name">
			exists
		</span>
					(<span class="var-type">accountName</span>&nbsp;<span class="var-name">$accountName</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">accountName</span>
				<span class="var-name">$accountName</span><span class="var-description">: the account name</span>			</li>
				</ul>
		
			
	</div>
<a name="methodgenerateStrongPassword" id="generateStrongPassword"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">generateStrongPassword</span> (line <span class="line-number">237</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Generate strong password that takes into account the user's information and old password. Implementations  should verify that the new password does not include information such as the username, fragments of the  old password, and other information that could be used to weaken the strength of the password.</p>
	<ul class="tags">
				<li><span class="field">return:</span> password with strong password strength</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">a</span>
		<span class="method-name">
			generateStrongPassword
		</span>
					([<span class="var-type">user</span>&nbsp;<span class="var-name">$user</span> = <span class="var-default">null</span>], [<span class="var-type">oldPassword</span>&nbsp;<span class="var-name">$oldPassword</span> = <span class="var-default">null</span>])
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">user</span>
				<span class="var-name">$user</span><span class="var-description">: the user whose information to use when generating password</span>			</li>
					<li>
				<span class="var-type">oldPassword</span>
				<span class="var-name">$oldPassword</span><span class="var-description">: the old password to use when verifying strength of new password.  The new password may be checked for fragments of oldPassword.</span>			</li>
				</ul>
		
			
	</div>
<a name="methodgetAllHashedPasswords" id="getAllHashedPasswords"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">getAllHashedPasswords</span> (line <span class="line-number">314</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Returns all of the specified User's hashed passwords.  If the User's list of passwords is null,  and create is set to true, an empty password list will be associated with the specified User  and then returned. If the User's password map is null and create is set to false, an exception  will be thrown.</p>
	<ul class="tags">
				<li><span class="field">return:</span> List containing all of the specified User's password hashes</li>
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">a</span>
		<span class="method-name">
			getAllHashedPasswords
		</span>
					(<span class="var-type">user</span>&nbsp;<span class="var-name">$user</span>, <span class="var-type">create</span>&nbsp;<span class="var-name">$create</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">user</span>
				<span class="var-name">$user</span><span class="var-description">: the User whose old hashes should be returned</span>			</li>
					<li>
				<span class="var-type">create</span>
				<span class="var-name">$create</span><span class="var-description">: true - if no password list is associated with this user, create one          false - if no password list is associated with this user, do not create one</span>			</li>
				</ul>
		
			
	</div>
<a name="methodgetCurrentUser" id="getCurrentUser"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">getCurrentUser</span> (line <span class="line-number">445</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Returns the currently logged in User.</p>
	<ul class="tags">
				<li><span class="field">return:</span> matching User object, or the Anonymous User if no match          exists</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">the</span>
		<span class="method-name">
			getCurrentUser
		</span>
				()
			</div>
	
		
			
	</div>
<a name="methodgetHashedPassword" id="getHashedPassword"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">getHashedPassword</span> (line <span class="line-number">336</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Return the specified User's current hashed password.</p>
	<ul class="tags">
				<li><span class="field">return:</span> specified User's current hashed password</li>
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">the</span>
		<span class="method-name">
			getHashedPassword
		</span>
					(<span class="var-type">user</span>&nbsp;<span class="var-name">$user</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">user</span>
				<span class="var-name">$user</span><span class="var-description">: this User's current hashed password will be returned</span>			</li>
				</ul>
		
			
	</div>
<a name="methodgetOldPasswordHashes" id="getOldPasswordHashes"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">getOldPasswordHashes</span> (line <span class="line-number">351</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Get a List of the specified User's old password hashes.  This will not return the User's current  password hash.</p>
	<ul class="tags">
				<li><span class="field">return:</span> specified User's old password hashes</li>
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">the</span>
		<span class="method-name">
			getOldPasswordHashes
		</span>
					(<span class="var-type">user</span>&nbsp;<span class="var-name">$user</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">user</span>
				<span class="var-name">$user</span><span class="var-description">: he user whose old password hashes should be returned</span>			</li>
				</ul>
		
			
	</div>
<a name="methodgetUserById" id="getUserById"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">getUserById</span> (line <span class="line-number">369</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Returns the User matching the provided accountId.  If the accoundId is not found, an Anonymous  User or null may be returned.</p>
	<ul class="tags">
				<li><span class="field">return:</span> matching User object, or the Anonymous User if no match exists</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">the</span>
		<span class="method-name">
			getUserById
		</span>
					(<span class="var-type">accountId</span>&nbsp;<span class="var-name">$accountId</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">accountId</span>
				<span class="var-name">$accountId</span><span class="var-description">: the account id</span>			</li>
				</ul>
		
			
	</div>
<a name="methodgetUserByName" id="getUserByName"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">getUserByName</span> (line <span class="line-number">395</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Returns the User matching the provided accountName.  If the accoundId is not found, an Anonymous  User or null may be returned.</p>
	<ul class="tags">
				<li><span class="field">return:</span> matching User object, or the Anonymous User if no match exists</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">the</span>
		<span class="method-name">
			getUserByName
		</span>
					(<span class="var-type">accountName</span>&nbsp;<span class="var-name">$accountName</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">accountName</span>
				<span class="var-name">$accountName</span><span class="var-description">: the account name</span>			</li>
				</ul>
		
			
	</div>
<a name="methodgetUserNames" id="getUserNames"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">getUserNames</span> (line <span class="line-number">413</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Gets a collection containing all the existing user names.</p>
	<ul class="tags">
				<li><span class="field">return:</span> set of all user names</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">a</span>
		<span class="method-name">
			getUserNames
		</span>
				()
			</div>
	
		
			
	</div>
<a name="methodhashPassword" id="hashPassword"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">hashPassword</span> (line <span class="line-number">494</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Returns a $representation of the hashed password, using the  accountName as the salt. The salt helps to prevent against &quot;rainbow&quot;  table attacks where the attacker pre-calculates hashes for known strings.</p>
<p class="description"><p>This method specifies the use of the user's account name as the &quot;salt&quot;  value. The Encryptor.hash method can be used if a different salt is  required.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> hashed password</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">the</span>
		<span class="method-name">
			hashPassword
		</span>
					(<span class="var-type">password</span>&nbsp;<span class="var-name">$password</span>, <span class="var-type">accountName</span>&nbsp;<span class="var-name">$accountName</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">password</span>
				<span class="var-name">$password</span><span class="var-description">: the password to hash</span>			</li>
					<li>
				<span class="var-type">accountName</span>
				<span class="var-name">$accountName</span><span class="var-description">: the account name to use as the salt</span>			</li>
				</ul>
		
			
	</div>
<a name="methodloadUsersIfNecessary" id="loadUsersIfNecessary"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">loadUsersIfNecessary</span> (line <span class="line-number">187</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Load users if they haven't been loaded in a while.</p>
	<ul class="tags">
				<li><span class="field">access:</span> protected</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			loadUsersIfNecessary
		</span>
				()
			</div>
	
		
			
	</div>
<a name="methodloadUsersImmediately" id="loadUsersImmediately"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">loadUsersImmediately</span> (line <span class="line-number">209</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
	<ul class="tags">
				<li><span class="field">access:</span> protected</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			loadUsersImmediately
		</span>
				()
			</div>
	
		
			
	</div>
<a name="methodlogin" id="login"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">login</span> (line <span class="line-number">94</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This method should be called for every HTTP request, to login the current user either from the session of HTTP  request. This method will set the current user so that getCurrentUser() will work properly.</p>
<p class="description"><p>Authenticates the user's credentials from the HttpServletRequest if  necessary, creates a session if necessary, and sets the user as the  current user.</p><p>Specification:  The implementation should do the following:  	1) Check if the User is already stored in the session  		a. If so, check that session absolute and inactivity timeout have not expired  		b. Step 2 may not be required if 1a has been satisfied  	2) Verify User credentials  		a. It is recommended that you use  			loginWithUsernameAndPassword(HttpServletRequest, HttpServletResponse) to verify credentials  	3) Set the last host of the User (ex.  user.setLastHostAddress(address) )  	4) Verify that the request is secure (ex. over SSL)  	5) Verify the User account is allowed to be logged in  		a. Verify the User is not disabled, expired or locked  	6) Assign User to session variable</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> User</li>
				<li><span class="field">throws:</span> AuthenticationException              if the credentials are not verified, or if the account is disabled, locked, expired, or timed out</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">the</span>
		<span class="method-name">
			login
		</span>
					(<span class="var-type">request</span>&nbsp;<span class="var-name">$request</span>, <span class="var-type">response</span>&nbsp;<span class="var-name">$response</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">request</span>
				<span class="var-name">$request</span><span class="var-description">: the current HTTP request</span>			</li>
					<li>
				<span class="var-type">response</span>
				<span class="var-name">$response</span><span class="var-description">: the HTTP response</span>			</li>
				</ul>
		
			
	</div>
<a name="methodlogout" id="logout"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">logout</span> (line <span class="line-number">122</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Logs out the current user.</p>
<p class="description"><p>This is usually done by calling User.logout on the current User.</p></p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			logout
		</span>
				()
			</div>
	
		
			
	</div>
<a name="methodremoveUser" id="removeUser"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">removeUser</span> (line <span class="line-number">508</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Removes the account of the specified accountName.</p>
	<ul class="tags">
				<li><span class="field">throws:</span> AuthenticationException              the authentication exception if user does not exist</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			removeUser
		</span>
					(<span class="var-type">accountName</span>&nbsp;<span class="var-name">$accountName</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">accountName</span>
				<span class="var-name">$accountName</span><span class="var-description">: the account name to remove</span>			</li>
				</ul>
		
			
	</div>
<a name="methodsaveUsers" id="saveUsers"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">saveUsers</span> (line <span class="line-number">220</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Saves the user database to the file system. In this implementation you must call save to commit any changes to  the user file. Otherwise changes will be lost when the program ends.</p>
	<ul class="tags">
				<li><span class="field">throws:</span> AuthenticationException          if the user file could not be written</li>
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			saveUsers
		</span>
				()
			</div>
	
		
			
	</div>
<a name="methodsetCurrentUser" id="setCurrentUser"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">setCurrentUser</span> (line <span class="line-number">455</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Sets the currently logged in User.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			setCurrentUser
		</span>
					(<span class="var-type">user</span>&nbsp;<span class="var-name">$user</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">user</span>
				<span class="var-name">$user</span><span class="var-description">: the user to set as the current user</span>			</li>
				</ul>
		
			
	</div>
<a name="methodverifyAccountNameStrength" id="verifyAccountNameStrength"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">verifyAccountNameStrength</span> (line <span class="line-number">529</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Ensures that the account name passes site-specific complexity requirements, like minimum length.</p>
	<ul class="tags">
				<li><span class="field">throws:</span> AuthenticationException              if account name does not meet complexity requirements</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			verifyAccountNameStrength
		</span>
					(<span class="var-type">accountName</span>&nbsp;<span class="var-name">$accountName</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">accountName</span>
				<span class="var-name">$accountName</span><span class="var-description">: the account name</span>			</li>
				</ul>
		
			
	</div>
<a name="methodverifyPassword" id="verifyPassword"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">verifyPassword</span> (line <span class="line-number">113</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Verify that the supplied password matches the password for this user. Password should  be stored as a hash. It is recommended you use the hashPassword(password, accountName) method  in this class.</p>
<p class="description"><p>This method is typically used for &quot;reauthentication&quot; for the most sensitive functions, such  as transactions, changing email address, and changing other account information.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> if the password is correct for the specified user</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">true,</span>
		<span class="method-name">
			verifyPassword
		</span>
					(<span class="var-type">user</span>&nbsp;<span class="var-name">$user</span>, <span class="var-type">password</span>&nbsp;<span class="var-name">$password</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">user</span>
				<span class="var-name">$user</span><span class="var-description">: the user who requires verification</span>			</li>
					<li>
				<span class="var-type">password</span>
				<span class="var-name">$password</span><span class="var-description">: the hashed user-supplied password</span>			</li>
				</ul>
		
			
	</div>
<a name="methodverifyPasswordStrength" id="verifyPasswordStrength"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">verifyPasswordStrength</span> (line <span class="line-number">554</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Ensures that the password meets site-specific complexity requirements, like length or number</p>
<p class="description"><p>of character sets. This method takes the old password so that the algorithm can analyze the  new password to see if it is too similar to the old password. Note that this has to be  invoked when the user has entered the old password, as the list of old  credentials stored by ESAPI is all hashed.</p></p>
	<ul class="tags">
				<li><span class="field">throws:</span> AuthenticationException                 if newPassword is too similar to oldPassword or if newPassword does not meet complexity requirements</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			verifyPasswordStrength
		</span>
					(<span class="var-type">oldPassword</span>&nbsp;<span class="var-name">$oldPassword</span>, <span class="var-type">newPassword</span>&nbsp;<span class="var-name">$newPassword</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">oldPassword</span>
				<span class="var-name">$oldPassword</span><span class="var-description">: the old password</span>			</li>
					<li>
				<span class="var-type">newPassword</span>
				<span class="var-name">$newPassword</span><span class="var-description">: the new password</span>			</li>
				</ul>
		
			
	</div>
						
		</div>
	</div>


	<p class="notes" id="credit">
		Documentation generated on Fri, 16 Apr 2010 12:00:11 -0400 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.4.3</a>
	</p>
	</div></body>
</html>