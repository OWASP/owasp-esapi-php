<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos -->
			<title>Docs For Class FileBasedAccessController</title>
			<link rel="stylesheet" href="../media/stylesheet.css" />
			<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'/>
		</head>
		<body>
			<div class="page-body">			
<h2 class="class-name">Class FileBasedAccessController</h2>

<a name="sec-description"></a>
<div class="info-box">
	<div class="info-box-title">Description</div>
	<div class="nav-bar">
					<span class="disabled">Description</span> |
															<a href="#sec-method-summary">Methods</a> (<a href="#sec-methods">details</a>)
						
					</div>
	<div class="info-box-body">
                <p class="implements">
            Implements interfaces:
            <ul>
                <li><a href="../ESAPI/AccessController.html">AccessController</a></li>            </ul>
        </p>
        		<!-- ========== Info from phpDoc block ========= -->
		<p class="notes">
			Located in <a class="field" href="_reference---FileBasedAccessController.php.html">/reference/FileBasedAccessController.php</a> (line <span class="field">22</span>)
		</p>
		
				
		<pre></pre>
	
			</div>
</div>




	<a name="sec-method-summary"></a>
	<div class="info-box">
		<div class="info-box-title">Method Summary</span></div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
												<span class="disabled">Methods</span> (<a href="#sec-methods">details</a>)
		</div>
		<div class="info-box-body">			
			<div class="method-summary">
																																																																																																				
												<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#assertAuthorizedForData" title="details" class="method-name">assertAuthorizedForData</a>
											(<span class="var-type">action</span>&nbsp;<span class="var-name">$action</span>, <span class="var-type">data</span>&nbsp;<span class="var-name">$data</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#assertAuthorizedForDataByKey" title="details" class="method-name">assertAuthorizedForDataByKey</a>
											(<span class="var-type">key</span>&nbsp;<span class="var-name">$key</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#assertAuthorizedForFile" title="details" class="method-name">assertAuthorizedForFile</a>
											(<span class="var-type">filepath</span>&nbsp;<span class="var-name">$filepath</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#assertAuthorizedForFunction" title="details" class="method-name">assertAuthorizedForFunction</a>
											(<span class="var-type">functionName</span>&nbsp;<span class="var-name">$functionName</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#assertAuthorizedForService" title="details" class="method-name">assertAuthorizedForService</a>
											(<span class="var-type">serviceName</span>&nbsp;<span class="var-name">$serviceName</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#assertAuthorizedForURL" title="details" class="method-name">assertAuthorizedForURL</a>
											(<span class="var-type">url</span>&nbsp;<span class="var-name">$url</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">true,</span>
										<a href="#isAuthorizedForData" title="details" class="method-name">isAuthorizedForData</a>
											(<span class="var-type">action</span>&nbsp;<span class="var-name">$action</span>, <span class="var-type">data</span>&nbsp;<span class="var-name">$data</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">true,</span>
										<a href="#isAuthorizedForDataByKey" title="details" class="method-name">isAuthorizedForDataByKey</a>
											(<span class="var-type">key</span>&nbsp;<span class="var-name">$key</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">true,</span>
										<a href="#isAuthorizedForFile" title="details" class="method-name">isAuthorizedForFile</a>
											(<span class="var-type">filepath</span>&nbsp;<span class="var-name">$filepath</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">true,</span>
										<a href="#isAuthorizedForFunction" title="details" class="method-name">isAuthorizedForFunction</a>
											(<span class="var-type">functionName</span>&nbsp;<span class="var-name">$functionName</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">true,</span>
										<a href="#isAuthorizedForService" title="details" class="method-name">isAuthorizedForService</a>
											(<span class="var-type">serviceName</span>&nbsp;<span class="var-name">$serviceName</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">true,</span>
										<a href="#isAuthorizedForURL" title="details" class="method-name">isAuthorizedForURL</a>
											(<span class="var-type">url</span>&nbsp;<span class="var-name">$url</span>)
									</div>
								</div>
		</div>
	</div>		

	
	<a name="sec-methods"></a>
	<div class="info-box">
		<div class="info-box-title">Methods</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
																<a href="#sec-method-summary">Methods</a> (<span class="disabled">details</span>)
						
		</div>
		<div class="info-box-body">
			<A NAME='method_detail'></A>

<a name="methodassertAuthorizedForData" id="assertAuthorizedForData"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">assertAuthorizedForData</span> (line <span class="line-number">247</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Checks if the current user is authorized to access the referenced data.  This method simply returns if access is authorized.</p>
<p class="description"><p>It throws an AccessControlException if access is not authorized, or if the referenced data does not exist.  &lt;p&gt;
 Specification:  The implementation should do the following:  <ol><li>Check to see if the resource exists and if not, throw an AccessControlException</li><li>Use available information to make an access control decision</li><li>Ideally, this policy would be data driven</li><li>You can use the current User, roles, data type, data name, time of day, etc.</li><li>Access control decisions must deny by default</li></ol>  &lt;li&gt;If access is not permitted, throw an AccessControlException with details&lt;/li&gt;  &lt;/ol&gt;</p></p>
	<ul class="tags">
				<li><span class="field">throws:</span> AccessControlException          if access is not permitted</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			assertAuthorizedForData
		</span>
					(<span class="var-type">action</span>&nbsp;<span class="var-name">$action</span>, <span class="var-type">data</span>&nbsp;<span class="var-name">$data</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">action</span>
				<span class="var-name">$action</span><span class="var-description">: the action to check for in the configuration file in the resource directory</span>			</li>
					<li>
				<span class="var-type">data</span>
				<span class="var-name">$data</span><span class="var-description">: the data to check for in the configuration file in the resource directory</span>			</li>
				</ul>
		
			
	</div>
<a name="methodassertAuthorizedForDataByKey" id="assertAuthorizedForDataByKey"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">assertAuthorizedForDataByKey</span> (line <span class="line-number">217</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Checks if the current user is authorized to access the referenced data.  This method simply returns if access is authorized.</p>
<p class="description"><p>It throws an AccessControlException if access is not authorized, or if the referenced data does not exist.  &lt;p&gt;
 Specification:  The implementation should do the following:  <ol><li>Check to see if the resource exists and if not, throw an AccessControlException</li><li>Use available information to make an access control decision</li><li>Ideally, this policy would be data driven</li><li>You can use the current User, roles, data type, data name, time of day, etc.</li><li>Access control decisions must deny by default</li></ol>  &lt;li&gt;If access is not permitted, throw an AccessControlException with details&lt;/li&gt;  &lt;/ol&gt;</p></p>
	<ul class="tags">
				<li><span class="field">throws:</span> AccessControlException          if access is not permitted</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			assertAuthorizedForDataByKey
		</span>
					(<span class="var-type">key</span>&nbsp;<span class="var-name">$key</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">key</span>
				<span class="var-name">$key</span><span class="var-description">: the name of the target data object</span>			</li>
				</ul>
		
			
	</div>
<a name="methodassertAuthorizedForFile" id="assertAuthorizedForFile"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">assertAuthorizedForFile</span> (line <span class="line-number">275</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Checks if an account is authorized to access the referenced file. The implementation should validate and canonicalize the input to be sure the filepath is not malicious.</p>
<p class="description"><p>This method throws an AccessControlException if access is not authorized, or if the referenced File does not exist.  If the User is authorized, this method simply returns.</p><p>Specification:  The implementation should do the following:  <ol><li>Check to see if the File exists and if not, throw an AccessControlException</li><li>Use available information to make an access control decision</li><li>Ideally, this policy would be data driven</li><li>You can use the current User, roles, data type, data name, time of day, etc.</li><li>Access control decisions must deny by default</li></ol>  &lt;li&gt;If access is not permitted, throw an AccessControlException with details&lt;/li&gt;  &lt;/ol&gt;</p></p>
	<ul class="tags">
				<li><span class="field">throws:</span> AccessControlException if access is denied</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			assertAuthorizedForFile
		</span>
					(<span class="var-type">filepath</span>&nbsp;<span class="var-name">$filepath</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">filepath</span>
				<span class="var-name">$filepath</span><span class="var-description">: Path to the file to be checked</span>			</li>
				</ul>
		
			
	</div>
<a name="methodassertAuthorizedForFunction" id="assertAuthorizedForFunction"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">assertAuthorizedForFunction</span> (line <span class="line-number">191</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Checks if an account is authorized to access the referenced function. The implementation should define the function &quot;namespace&quot; to be enforced. Choosing something simple like the class name of action classes or menu item names will make this implementation easier to use.</p>
<p class="description"><p>This method throws an AccessControlException if access is not authorized, or if the referenced function does not exist.  If the User is authorized, this method simply returns.</p><p>Specification:  The implementation should do the following:  <ol><li>Check to see if the function exists and if not, throw an AccessControlException</li><li>Use available information to make an access control decision</li><li>Ideally, this policy would be data driven</li><li>You can use the current User, roles, data type, data name, time of day, etc.</li><li>Access control decisions must deny by default</li></ol>  &lt;li&gt;If access is not permitted, throw an AccessControlException with details&lt;/li&gt;  &lt;/ol&gt;</p></p>
	<ul class="tags">
				<li><span class="field">throws:</span> AccessControlException          if access is not permitted</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			assertAuthorizedForFunction
		</span>
					(<span class="var-type">functionName</span>&nbsp;<span class="var-name">$functionName</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">functionName</span>
				<span class="var-name">$functionName</span><span class="var-description">: the function name</span>			</li>
				</ul>
		
			
	</div>
<a name="methodassertAuthorizedForService" id="assertAuthorizedForService"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">assertAuthorizedForService</span> (line <span class="line-number">305</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Checks if an account is authorized to access the referenced service. This can be used in applications that provide access to a variety of backend services.</p>
<p class="description"><p>This method throws an AccessControlException if access is not authorized, or if the referenced service does not exist.  If the User is authorized, this method simply returns.</p><p>Specification:  The implementation should do the following:  <ol><li>Check to see if the service exists and if not, throw an AccessControlException</li><li>Use available information to make an access control decision</li><li>Ideally, this policy would be data driven</li><li>You can use the current User, roles, data type, data name, time of day, etc.</li><li>Access control decisions must deny by default</li></ol>  &lt;li&gt;If access is not permitted, throw an AccessControlException with details&lt;/li&gt;  &lt;/ol&gt;</p></p>
	<ul class="tags">
				<li><span class="field">throws:</span> AccessControlException          if access is not permitted</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			assertAuthorizedForService
		</span>
					(<span class="var-type">serviceName</span>&nbsp;<span class="var-name">$serviceName</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">serviceName</span>
				<span class="var-name">$serviceName</span><span class="var-description">: the service name</span>			</li>
				</ul>
		
			
	</div>
<a name="methodassertAuthorizedForURL" id="assertAuthorizedForURL"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">assertAuthorizedForURL</span> (line <span class="line-number">160</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Checks if an account is authorized to access the referenced URL. The implementation should allow</p>
<p class="description"><p>access to be granted to any part of the URL. Generally, this method should be invoked in the  application's controller or a filter as follows:  <pre>ESAPI.accessController().assertAuthorizedForURL(request.getRequestURI().toString());</pre></p><p>This method throws an AccessControlException if access is not authorized, or if the referenced URL does not exist.  If the User is authorized, this method simply returns.  &lt;p&gt;
 Specification:  The implementation should do the following:  <ol><li>Check to see if the resource exists and if not, throw an AccessControlException</li><li>Use available information to make an access control decision</li><li>Ideally, this policy would be data driven</li><li>You can use the current User, roles, data type, data name, time of day, etc.</li><li>Access control decisions must deny by default</li></ol>  &lt;li&gt;If access is not permitted, throw an AccessControlException with details&lt;/li&gt;  &lt;/ol&gt;</p></p>
	<ul class="tags">
				<li><span class="field">throws:</span> AccessControlException          if access is not permitted</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			assertAuthorizedForURL
		</span>
					(<span class="var-type">url</span>&nbsp;<span class="var-name">$url</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">url</span>
				<span class="var-name">$url</span><span class="var-description">: the URL as returned by request.getRequestURI().toString()</span>			</li>
				</ul>
		
			
	</div>
<a name="methodisAuthorizedForData" id="isAuthorizedForData"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">isAuthorizedForData</span> (line <span class="line-number">94</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Checks if an account is authorized to access the referenced data, represented as an Object.</p>
<p class="description"><p>The implementation of this method should call assertAuthorizedForData($action, Object data), and if an  AccessControlException is not thrown, this method should return true.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> if is authorized for the data</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">true,</span>
		<span class="method-name">
			isAuthorizedForData
		</span>
					(<span class="var-type">action</span>&nbsp;<span class="var-name">$action</span>, <span class="var-type">data</span>&nbsp;<span class="var-name">$data</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">action</span>
				<span class="var-name">$action</span><span class="var-description">: the action to check for in the configuration file in the resource directory</span>			</li>
					<li>
				<span class="var-type">data</span>
				<span class="var-name">$data</span><span class="var-description">: the data to check for in the configuration file in the resource directory</span>			</li>
				</ul>
		
			
	</div>
<a name="methodisAuthorizedForDataByKey" id="isAuthorizedForDataByKey"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">isAuthorizedForDataByKey</span> (line <span class="line-number">74</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Checks if an account is authorized to access the referenced data, represented as a String.</p>
<p class="description"><p>The implementation of this method should call assertAuthorizedForData($key), and if an AccessControlException  is not thrown, this method should return true.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> if is authorized for the data</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">true,</span>
		<span class="method-name">
			isAuthorizedForDataByKey
		</span>
					(<span class="var-type">key</span>&nbsp;<span class="var-name">$key</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">key</span>
				<span class="var-name">$key</span><span class="var-description">: the name of the referenced data object</span>			</li>
				</ul>
		
			
	</div>
<a name="methodisAuthorizedForFile" id="isAuthorizedForFile"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">isAuthorizedForFile</span> (line <span class="line-number">111</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Checks if an account is authorized to access the referenced file.</p>
<p class="description"><p>The implementation of this method should call assertAuthorizedForFile($filepath), and if an AccessControlException  is not thrown, this method should return true.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> if is authorized for the file</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">true,</span>
		<span class="method-name">
			isAuthorizedForFile
		</span>
					(<span class="var-type">filepath</span>&nbsp;<span class="var-name">$filepath</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">filepath</span>
				<span class="var-name">$filepath</span><span class="var-description">: the path of the file to be checked, including filename</span>			</li>
				</ul>
		
			
	</div>
<a name="methodisAuthorizedForFunction" id="isAuthorizedForFunction"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">isAuthorizedForFunction</span> (line <span class="line-number">57</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Checks if an account is authorized to access the referenced function.</p>
<p class="description"><p>The implementation of this method should call assertAuthorizedForFunction($functionName), and if an  AccessControlException is not thrown, this method should return true.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> if is authorized for function</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">true,</span>
		<span class="method-name">
			isAuthorizedForFunction
		</span>
					(<span class="var-type">functionName</span>&nbsp;<span class="var-name">$functionName</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">functionName</span>
				<span class="var-name">$functionName</span><span class="var-description">: the name of the function</span>			</li>
				</ul>
		
			
	</div>
<a name="methodisAuthorizedForService" id="isAuthorizedForService"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">isAuthorizedForService</span> (line <span class="line-number">129</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Checks if an account is authorized to access the referenced service. This can be used in applications that  provide access to a variety of back end services.</p>
<p class="description"><p>The implementation of this method should call assertAuthorizedForService($serviceName), and if an  AccessControlException is not thrown, this method should return true.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> if is authorized for the service</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">true,</span>
		<span class="method-name">
			isAuthorizedForService
		</span>
					(<span class="var-type">serviceName</span>&nbsp;<span class="var-name">$serviceName</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">serviceName</span>
				<span class="var-name">$serviceName</span><span class="var-description">: the service name</span>			</li>
				</ul>
		
			
	</div>
<a name="methodisAuthorizedForURL" id="isAuthorizedForURL"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">isAuthorizedForURL</span> (line <span class="line-number">40</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Checks if an account is authorized to access the referenced URL. Generally, this method should be invoked in the  application's controller or a filter as follows:  <pre>ESAPI.accessController().isAuthorizedForURL(request.getRequestURI().toString());</pre></p>
<p class="description"><p>The implementation of this method should call assertAuthorizedForURL($url), and if an AccessControlException is  not thrown, this method should return true. This way, if the user is not authorized, false would be returned, and the  exception would be logged.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> if is authorized for URL</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">true,</span>
		<span class="method-name">
			isAuthorizedForURL
		</span>
					(<span class="var-type">url</span>&nbsp;<span class="var-name">$url</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">url</span>
				<span class="var-name">$url</span><span class="var-description">: the URL as returned by request.getRequestURI().toString()</span>			</li>
				</ul>
		
			
	</div>
						
		</div>
	</div>


	<p class="notes" id="credit">
		Documentation generated on Fri, 16 Apr 2010 12:00:10 -0400 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.4.3</a>
	</p>
	</div></body>
</html>